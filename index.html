<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSBridge Message Handler</title>

    <div id="countdown-container" style="width: 80%; max-width: 400px; margin: 30px auto; font-family: sans-serif;">
      <div id="countdown-text" style="text-align:center; font-weight:bold; margin-bottom:10px;">
      </div>
      <div style="width: 100%; height: 20px; background: #eee; border-radius: 10px;">
        <div id="progress-bar" style="width:0%; height:100%; background: #4caf50; border-radius: 10px;"></div>
      </div>
    </div>
    
    <script>
      window.addEventListener("load", function () {
        const totalSeconds = 5;
        let secondsLeft = totalSeconds;

        const countdownContainer = document.getElementById("countdown-container");
        const countdownText = document.getElementById("countdown-text");
        const progressBar = document.getElementById("progress-bar");

        const interval = setInterval(() => {
          secondsLeft--;

          countdownText.textContent = `Skrypt za≈Çaduje siƒô za ${secondsLeft} sekund...`;

          const progressPercent = ((totalSeconds - secondsLeft) / totalSeconds) * 100;
          progressBar.style.width = progressPercent + "%";

          if (secondsLeft <= 0) {
            clearInterval(interval);
            countdownText.textContent = "≈Åadowanie skryptu...";

            const script = document.createElement("script");
            script.src = "//cdn.evgnet.com/beacon/partnerpwcpoland/jsbridge/scripts/evergage.min.js";
            script.type = "text/javascript";
            document.head.appendChild(script);

            console.log("‚ö° Evergage script loaded after delay");

            countdownContainer.style.display = "none";
          }
        }, 1000);
      });
    </script>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .content {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        #jsbridge-messages {
            background-color: #e8f4fd;
            border: 1px solid #b3d9ff;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .message-item {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .message-time {
            color: #666;
            font-size: 0.8em;
            margin-bottom: 5px;
        }
        .message-content {
            font-family: monospace;
            background-color: #f5f5f5;
            padding: 8px;
            border-radius: 3px;
            word-break: break-all;
        }
        .message-location {
            color: #007bff;
            font-weight: bold;
            margin-top: 5px;
        }
        .fire-btn {
            display: block;
            margin: 30px auto;
            padding: 12px 24px;
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }
        .fire-btn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="content">
        <h2>JSBridge Wiadomo≈õci</h2>
        <div id="jsbridge-messages">
            <p>Oczekiwanie na wiadomo≈õci z JSBridge...</p>
        </div>
        <div id="message-log"></div>
    </div>

    <!-- ‚úÖ Button at the bottom -->
    <button class="fire-btn" id="fireButton">üî• Fire Event</button>

    <script>
        document.getElementById("fireButton").addEventListener("click", function() {
            if (typeof SalesforceInteractions !== "undefined") {
                SalesforceInteractions.sendEvent({
                    interaction: {
                        name: "Fire",
                    }
                });
                console.log("‚úÖ SalesforceInteractions event fired");
            } else {
                console.warn("‚ö†Ô∏è SalesforceInteractions is not available.");
            }
        });
    </script>
</body>
</html>
